package be.dekleinekobini.tornapi.models.user;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.jupiter.api.Test;

import java.time.LocalDateTime;
import java.util.HashMap;
import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;

class LogTest {

    @Test
    void of() throws JsonProcessingException {
        // Arrange
        ObjectMapper objectMapper = new ObjectMapper();
        JsonNode json = objectMapper.readTree("{\"log\":{\"tjCRrodPc4sKU27QV7Co\":{\"log\":7815,\"title\":\"Missions complete\",\"timestamp\":1639681245,\"category\":\"Missions\",\"data\":{\"type\":\"contract\",\"agent\":3,\"mission\":19,\"difficulty\":\"expert\",\"money\":56000,\"credits\":35},\"params\":{\"color\":\"green\"}},\"5YTWWLz7EVwPCUfeJt3g\":{\"log\":8155,\"title\":\"Attack mug\",\"timestamp\":1639681227,\"category\":\"Attacking\",\"data\":{\"defender\":302681,\"anonymous\":0,\"energy_used\":25,\"money_mugged\":8012,\"attackers\":1,\"chain\":1,\"log\":\"[<a href = \\\"/loader.php?sid=attackLog&ID=aaaa3013200f2112a8eaf11faa105f1a\\\"target = \\\"_self\\\">view</a>]\"},\"params\":{\"color\":\"green\"}},\"hbFmgDgszH03icVzuisT\":{\"log\":7800,\"title\":\"Missions accept\",\"timestamp\":1639681191,\"category\":\"Missions\",\"data\":{\"type\":\"contract\",\"agent\":3,\"mission\":19,\"difficulty\":\"expert\"},\"params\":[]},\"2G73iZoMsJTZkllpXoHV\":{\"log\":7900,\"title\":\"Missions buy reward item\",\"timestamp\":1639681028,\"category\":\"Missions\",\"data\":{\"item\":8,\"quantity\":1,\"credits_spent\":3},\"params\":{\"color\":\"green\"}},\"J4vyCI4eZiJzOo5AbrFT\":{\"log\":7900,\"title\":\"Missions buy reward item\",\"timestamp\":1639681025,\"category\":\"Missions\",\"data\":{\"item\":612,\"quantity\":1,\"credits_spent\":92},\"params\":{\"color\":\"green\"}},\"XuHCyDaZ6oVvFW6VKa5V\":{\"log\":7900,\"title\":\"Missions buy reward item\",\"timestamp\":1639681020,\"category\":\"Missions\",\"data\":{\"item\":226,\"quantity\":5,\"credits_spent\":64},\"params\":{\"color\":\"green\"}},\"0ebP80saS9TQVe8psd3M\":{\"log\":7910,\"title\":\"Missions buy reward mod\",\"timestamp\":1639681014,\"category\":\"Missions\",\"data\":{\"mod\":9,\"credits_spent\":518},\"params\":{\"color\":\"green\"}},\"v0o74rAsHG2oqLMZ3p0m\":{\"log\":7900,\"title\":\"Missions buy reward item\",\"timestamp\":1639681009,\"category\":\"Missions\",\"data\":{\"item\":391,\"quantity\":1,\"credits_spent\":22},\"params\":{\"color\":\"green\"}},\"tujsJ1I00W4WSRZNirim\":{\"log\":7900,\"title\":\"Missions buy reward item\",\"timestamp\":1639681007,\"category\":\"Missions\",\"data\":{\"item\":231,\"quantity\":1,\"credits_spent\":11},\"params\":{\"color\":\"green\"}},\"X2kL7PjqIH6F3klj6GzX\":{\"log\":7900,\"title\":\"Missions buy reward item\",\"timestamp\":1639681004,\"category\":\"Missions\",\"data\":{\"item\":254,\"quantity\":1,\"credits_spent\":9},\"params\":{\"color\":\"green\"}},\"jXg4lkBIhFQKyTtjtkvF\":{\"log\":6221,\"title\":\"Company employee pay\",\"timestamp\":1639678138,\"category\":\"Company\",\"data\":{\"pay\":0,\"job_points\":10,\"working_stats_received\":\"0,49,25\",\"company\":86818},\"params\":{\"italic\":1,\"color\":\"green\"}},\"V8aHvp78ofIx6NS8lTdk\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639675556,\"category\":\"Jail\",\"data\":{\"user\":2028764,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"VWrxD3i3TIEXBh9i486G\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639675553,\"category\":\"Jail\",\"data\":{\"user\":2698799,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"OiOdU5FuZAYcnHDyP0gG\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639675552,\"category\":\"Jail\",\"data\":{\"user\":1765316,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"yzztLBZCUkJDIQeqXYOo\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639675523,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":89},\"params\":{\"color\":\"green\"}},\"l2rVQnCT6Fc9Fz0XHzGo\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639675521,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":77},\"params\":{\"color\":\"green\"}},\"Gpl9EWlQlOipvsmu4jkI\":{\"log\":5302,\"title\":\"Gym train speed\",\"timestamp\":1639675517,\"category\":\"Gym\",\"data\":{\"trains\":1,\"energy_used\":25,\"speed_before\":\"547156478.92883\",\"speed_after\":547224052.2189759,\"speed_increased\":67573.290145848,\"happy_used\":10,\"gym\":26},\"params\":{\"color\":\"green\",\"changed\":1591103100}},\"ECCmsAirlXoai2JSoLbI\":{\"log\":6781,\"title\":\"Faction organized crimes plan receive\",\"timestamp\":1639675177,\"category\":\"Faction\",\"data\":{\"faction\":33007,\"planner\":601684,\"crime\":7,\"hours\":168},\"params\":{\"italic\":1}},\"2X4QleBFg1P8FQhmaFdH\":{\"log\":6791,\"title\":\"Faction organized crimes initiate receive\",\"timestamp\":1639675162,\"category\":\"Faction\",\"data\":{\"faction\":33007,\"initiator\":601684,\"crime\":7,\"result\":\"success\"},\"params\":{\"italic\":1}},\"uFefa7cdVaZvTY7lVA4c\":{\"log\":5302,\"title\":\"Gym train speed\",\"timestamp\":1639672298,\"category\":\"Gym\",\"data\":{\"trains\":3,\"energy_used\":75,\"speed_before\":\"546953725.89283\",\"speed_after\":547156478.9288287,\"speed_increased\":202753.03599865796,\"happy_used\":39,\"gym\":26},\"params\":{\"color\":\"green\",\"changed\":1591103100}},\"m8z5BUColXf0ltTrgZCh\":{\"log\":500,\"title\":\"Captcha validation success\",\"timestamp\":1639672294,\"category\":\"Captcha\",\"data\":{\"type\":\"image captcha\"},\"params\":[]},\"09x8kStHjh1C9ljSOiLE\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639666144,\"category\":\"Jail\",\"data\":{\"user\":2551510,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"lkHinKUdmAKGHtCpdHLI\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639666142,\"category\":\"Jail\",\"data\":{\"user\":1875959,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"JPkT8Aa4syY84xD2KmMM\":{\"log\":5362,\"title\":\"Bust failure\",\"timestamp\":1639666140,\"category\":\"Jail\",\"data\":{\"user\":2551510,\"nerve_used\":3},\"params\":{\"color\":\"red\"}},\"0CHcDxPHMG9rhllxD8bt\":{\"log\":101,\"title\":\"Successful login\",\"timestamp\":1639663973,\"category\":\"Authentication\",\"data\":{\"ip_address\":\"hidden\"},\"params\":[]},\"cuciZlxrmhLtW23ESciC\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639663714,\"category\":\"Jail\",\"data\":{\"user\":2244170,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"SvJphkN9L4kYhWYJnhbT\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639663707,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":78},\"params\":{\"color\":\"green\"}},\"Snv1Hc7cSZSEgey6R609\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639663705,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":77},\"params\":{\"color\":\"green\"}},\"Anh8QydDdsiNB2MgZNBG\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639663703,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":77},\"params\":{\"color\":\"green\"}},\"6kQOVgzGAsMAFM481Jhp\":{\"log\":5302,\"title\":\"Gym train speed\",\"timestamp\":1639663698,\"category\":\"Gym\",\"data\":{\"trains\":14,\"energy_used\":350,\"speed_before\":\"546006952.04564\",\"speed_after\":546953725.892831,\"speed_increased\":946773.84719095,\"happy_used\":171,\"gym\":26},\"params\":{\"color\":\"green\",\"changed\":1591103100}},\"7wp17k7kALBLjdyEjGyF\":{\"log\":500,\"title\":\"Captcha validation success\",\"timestamp\":1639663672,\"category\":\"Captcha\",\"data\":{\"type\":\"image captcha\"},\"params\":[]},\"OwHGS8czcf0XycxECHhR\":{\"log\":2290,\"title\":\"Item use xanax\",\"timestamp\":1639663669,\"category\":\"Drugs\",\"data\":{\"item\":206,\"faction\":0},\"params\":{\"color\":\"green\"}},\"mvSiijnTYMvCsggQG7kJ\":{\"log\":101,\"title\":\"Successful login\",\"timestamp\":1639652587,\"category\":\"Authentication\",\"data\":{\"ip_address\":\"hidden\"},\"params\":[]},\"DBxSAQxa2YIPDn3eYk2t\":{\"log\":5362,\"title\":\"Bust failure\",\"timestamp\":1639652426,\"category\":\"Jail\",\"data\":{\"user\":1699726,\"nerve_used\":3},\"params\":{\"color\":\"red\"}},\"2fqZOntDuqWjXubjAa3W\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639652425,\"category\":\"Jail\",\"data\":{\"user\":2072739,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"irChFpyJdwjpnCJd1LFL\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639652396,\"category\":\"Jail\",\"data\":{\"user\":2575809,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"k2BtcBSMC2N5WruXLkhC\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652391,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"fW98fT6lnQCCeRY8tHii\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652390,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"DnEkj2xCjBfDb4zUOdlL\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652390,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":2},\"params\":{\"color\":\"green\"}},\"TEOa577G8PBGhdP7okuc\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652390,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":2},\"params\":{\"color\":\"green\"}},\"TLHekin5ADIhO6CTSFVm\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652389,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"8DyGJ5chDk6MqiiA7Lox\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652389,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"mwt3AnImnbmkCbl43ANM\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652388,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"MufywIrPiZQIYdX17tK5\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652388,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":2},\"params\":{\"color\":\"green\"}},\"0LR4qNC5VjEJBw1Qqg9L\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652388,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"JArSFPVxbDCI8xvjecV6\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639652381,\"category\":\"Jail\",\"data\":{\"user\":2319550,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"TvrPxS1YYH2C1LFrFucv\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639652379,\"category\":\"Jail\",\"data\":{\"user\":1586073,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"RfiHhp2cyJKSW5tOG07j\":{\"log\":5360,\"title\":\"Bust success\",\"timestamp\":1639652378,\"category\":\"Jail\",\"data\":{\"user\":1907251,\"nerve_used\":3},\"params\":{\"color\":\"green\"}},\"qMznjEKcyonTIgXDzvpk\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652370,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"TMItDcKslRm026x7VlFh\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652369,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"yZywIlIJKBRwZ0EDsPNG\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652369,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"h3lJY4yhAMXBcAvGjXPh\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652368,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"gvDqLBbcrtUwrL3ZXnAO\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652368,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"HGt9PNJByDe9DTCgTpkP\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652368,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"C7bQWYJj4F8z1hmDHWpu\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652367,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":2},\"params\":{\"color\":\"green\"}},\"DJveVSIErcb8Vj94P36x\":{\"log\":2030,\"title\":\"Item use alcohol\",\"timestamp\":1639652367,\"category\":\"Item use\",\"data\":{\"item\":180,\"faction\":0,\"nerve_increased\":1},\"params\":{\"color\":\"green\"}},\"cV57u9mge02EuvgEmz67\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639652363,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":89},\"params\":{\"color\":\"green\"}},\"9V04XSR26yTKRuqNlVvW\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639652362,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":95},\"params\":{\"color\":\"green\"}},\"CeYx3n6dskD9xZadfCxM\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639652361,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":77},\"params\":{\"color\":\"green\"}},\"ZFXhWIAHgbEJW9fj0Kuo\":{\"log\":5725,\"title\":\"Crime success item gain\",\"timestamp\":1639652360,\"category\":\"Crimes\",\"data\":{\"crime\":69,\"nerve\":12,\"item_gained\":92},\"params\":{\"color\":\"green\"}},\"SXVSWaG5nEZzBGtMCWna\":{\"log\":5302,\"title\":\"Gym train speed\",\"timestamp\":1639652356,\"category\":\"Gym\",\"data\":{\"trains\":4,\"energy_used\":100,\"speed_before\":\"545736538.9536\",\"speed_after\":546006952.0456429,\"speed_increased\":270413.09204278595,\"happy_used\":45,\"gym\":26},\"params\":{\"color\":\"green\",\"changed\":1591103100}},\"cDCC8mYBt3fkCDYJ99Le\":{\"log\":7420,\"title\":\"Forums rate\",\"timestamp\":1639652301,\"category\":\"Forums\",\"data\":{\"thread\":16254659,\"forum\":44,\"post\":22025131,\"type\":\"post in\",\"rating\":\"liked\",\"author\":1979277},\"params\":[]},\"MVqOj9wA2TTjWkujTBNR\":{\"log\":7401,\"title\":\"Forums create post\",\"timestamp\":1639652297,\"category\":\"Forums\",\"data\":{\"thread\":16254659,\"forum\":44,\"post\":22025170},\"params\":[]},\"irffZmD4Zehv90Fz5lBq\":{\"log\":130,\"title\":\"2FA Authenticator code entry successful\",\"timestamp\":1639652242,\"category\":\"Authentication\",\"data\":{\"ip_address\":\"hidden\"},\"params\":[]},\"Z3FVc2gEXE2D4aH3g4HY\":{\"log\":313,\"title\":\"Authorised device add/remove\",\"timestamp\":1639652242,\"category\":\"Preferences\",\"data\":{\"result\":\"added\",\"device_removed\":\"Mobile (Android & Chrome)\"},\"params\":[]},\"oiultUlgbYtDxaFRf1cj\":{\"log\":7420,\"title\":\"Forums rate\",\"timestamp\":1639651524,\"category\":\"Forums\",\"data\":{\"thread\":16254556,\"forum\":2,\"post\":22023376,\"type\":\"post in\",\"rating\":\"disliked\",\"author\":1867864},\"params\":[]}}}\n");

        // Act
        Map<String, Log> result = Log.of(json);

        // Assert
        Map<String, Object> data1 = new HashMap<>();
        data1.put("user", 1765316);
        data1.put("nerve_used", 3);

        Log log1 = new Log();
        log1.setLog(5360);
        log1.setTitle("Bust success");
        log1.setTimestamp(LocalDateTime.of(2021, 12, 16, 17, 25, 52));
        log1.setCategory("Jail");
        log1.setData(data1);

        Map<String, Object> data2 = new HashMap<>();
        data2.put("type", "image captcha");

        Log log2 = new Log();
        log2.setLog(500);
        log2.setTitle("Captcha validation success");
        log2.setTimestamp(LocalDateTime.of(2021, 12, 16, 16, 31, 34));
        log2.setCategory("Captcha");
        log2.setData(data2);

        assertThat(result)
                .hasSize(66)
                .containsEntry("OiOdU5FuZAYcnHDyP0gG", log1)
                .containsEntry("m8z5BUColXf0ltTrgZCh", log2);
    }

}